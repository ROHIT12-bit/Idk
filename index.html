<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BotsKingdoms AnimeBot</title>

<style>
    body{
        margin:0;
        background:#000;
        font-family:"Poppins",sans-serif;
        overflow-x:hidden;
        display:flex;
        justify-content:center;
        align-items:center;
        min-height:100vh;
    }

    .screen{
        width:100%;
        max-width:1920px;
        height:auto;
        background:#0e0e0e;
        overflow:hidden;
    }

    /* Search Bar */
    .searchbar{
        text-align:center;
        padding:18px;
        background:#111;
        border-bottom:2px solid #202020;
    }
    .searchbar input{
        width:70%;
        padding:16px 22px;
        border-radius:40px;
        border:none;
        background:#181818;
        color:#fff;
        font-size:20px;
        outline:none;
        box-shadow:0 0 10px rgba(0,255,255,.3);
    }

    /* Layout flexible */
    .main{
        display:flex;
        flex-direction:row;
        width:100%;
        min-height:90vh;
    }

    .left{
        width:50%;
        background:#000;
    }
    .left img{
        width:100%;
        height:100%;
        object-fit:cover;
    }

    .right{
        width:50%;
        padding:70px;
        color:#fff;
        display:flex;
        flex-direction:column;
        justify-content:center;
    }

    #title{
        font-size:55px;
        font-weight:900;
        text-shadow:0 0 18px cyan;
        margin-bottom:25px;
    }

    #desc{
        font-size:19px;
        line-height:1.6;
        opacity:.9;
        margin-bottom:40px;
        padding:20px;
        border-radius:15px;
        background:rgba(255,255,255,.08);
        backdrop-filter:blur(10px);
    }

    .btn, .download-btn{
        font-size:23px;
        padding:16px 45px;
        border-radius:50px;
        border:none;
        cursor:pointer;
        font-weight:700;
        margin-right:10px;
        margin-top:10px;
        transition:.3s;
    }

    .btn{
        background:linear-gradient(90deg,#00ffff,#0070ff);
        color:black;
    }
    .btn:hover{transform:scale(1.07);}

    .download-btn{
        background:#fff;
        color:#000;
    }
    .download-btn:hover{
        transform:scale(1.07);
        box-shadow:0 0 20px #fff;
    }

    .brand{
        text-align:center;
        color:#0ff;
        font-size:22px;
        padding:15px;
        text-shadow:0 0 12px cyan;
    }

    /* MOBILE RESPONSIVE */
    @media(max-width:900px){
        .main{flex-direction:column;}
        .left,.right{width:100%;}
        .right{padding:30px;}
        #title{font-size:40px;}
        #desc{font-size:17px;}
        .searchbar input{width:90%;}
        body{height:auto;}
    }
</style>
</head>
<body>

<div class="screen">

    <div class="searchbar">
        <input id="animeName" placeholder="Enter Anime name & press Enter..."
            onkeydown="if(event.key==='Enter') loadAnime(animeName.value)">
    </div>

    <div class="main">
        <div class="left">
            <img id="poster" src="">
        </div>

        <div class="right">
            <h1 id="title">BotsKingdoms AnimeBot</h1>
            <p id="desc">Type an anime name to load full details & download the poster image with text.</p>

            <div style="display:flex;flex-wrap:wrap;">
                <button class="btn">WATCH NOW</button>
                <button class="download-btn" onclick="downloadImageWithText()">DOWNLOAD IMAGE</button>
            </div>
        </div>
    </div>

    <div class="brand">Powered By BotsKingdoms ðŸ‘‘</div>
</div>

<script>
let currentAnime = {};

async function loadAnime(name){
    const q=`query($search:String){Media(search:$search,type:ANIME){
        title{english romaji} description coverImage{extraLarge} bannerImage
    }}`;
    
    let res=await fetch("https://graphql.anilist.co",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({query:q,variables:{search:name}})
    });

    let a=(await res.json()).data.Media;
    currentAnime = a; // Store for download

    document.getElementById("title").innerText=a.title.english||a.title.romaji;
    document.getElementById("desc").innerHTML=a.description ? a.description.slice(0,800)+"..." : "No description available.";
    document.getElementById("poster").src=a.bannerImage||a.coverImage.extraLarge;
}

// Download canvas with image + text
function downloadImageWithText(){
    if(!currentAnime || (!currentAnime.bannerImage && !currentAnime.coverImage)){
        alert("No anime loaded!");
        return;
    }

    const imgSrc = currentAnime.bannerImage || currentAnime.coverImage.extraLarge;
    const title = currentAnime.title.english || currentAnime.title.romaji;
    const desc = currentAnime.description ? currentAnime.description.slice(0,400) : "";

    const canvas = document.createElement("canvas");
    canvas.width = 1920;
    canvas.height = 1200;
    const ctx = canvas.getContext("2d");

    const img = new Image();
    img.crossOrigin = "anonymous";
    img.src = imgSrc;
    img.onload = ()=>{
        // Draw background image
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

        // Draw overlay
        ctx.fillStyle = "rgba(0,0,0,0.5)";
        ctx.fillRect(0, canvas.height - 400, canvas.width, 400);

        // Draw title
        ctx.fillStyle = "#00ffff";
        ctx.font = "bold 70px Poppins, sans-serif";
        ctx.shadowColor = "cyan";
        ctx.shadowBlur = 20;
        ctx.fillText(title, 50, canvas.height - 300);

        // Draw description
        ctx.fillStyle = "#fff";
        ctx.font = "28px Poppins, sans-serif";
        ctx.shadowBlur = 0;

        // Wrap text
        const words = desc.split(" ");
        let line = "";
        let y = canvas.height - 230;
        for(let n = 0; n < words.length; n++){
            let testLine = line + words[n] + " ";
            let metrics = ctx.measureText(testLine);
            if(metrics.width > canvas.width - 100){
                ctx.fillText(line, 50, y);
                line = words[n] + " ";
                y += 35;
            } else {
                line = testLine;
            }
        }
        ctx.fillText(line, 50, y);

        // Download
        const link = document.createElement("a");
        link.download = "anime_with_text.jpg";
        link.href = canvas.toDataURL("image/jpeg", 1.0);
        link.click();
    }
}
</script>

</body>
</html>
